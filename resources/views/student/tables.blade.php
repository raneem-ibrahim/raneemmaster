{{-- <div class="container-fluid py-2">
    <div class="row">
        <div class="col-12">
          <div class="card my-4">
            <div class="card-header p-0 position-relative mt-n4 mx-3 z-index-2">
              <div class="bg-gradient-dark shadow-dark border-radius-lg pt-4 pb-3">
                <h6 class="text-white text-capitalize ps-3">جدول المؤلفين</h6>
              </div>
            </div>
            <div class="card-body px-0 pb-2">
              <div class="table-responsive p-0">
                <table class="table align-items-center mb-0" dir="rtl">
                  <thead>
                    <tr>
                      <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">المؤلف</th>
                      <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 ps-2">الوظيفة</th>
                      <th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">الحالة</th>
                      <th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">تم التوظيف</th>
                      <th class="text-secondary opacity-7"></th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>
                        <div class="d-flex px-2 py-1">
                          <div>
                            <img src="../assets/img/team-2.jpg" class="avatar avatar-sm me-3 border-radius-lg" alt="user1">
                          </div>
                          <div class="d-flex flex-column justify-content-center">
                            <h6 class="mb-0 text-sm">جون مايكل</h6>
                            <p class="text-xs text-secondary mb-0">john@creative-tim.com</p>
                          </div>
                        </div>
                      </td>
                      <td>
                        <p class="text-xs font-weight-bold mb-0">مدير</p>
                        <p class="text-xs text-secondary mb-0">المنظمة</p>
                      </td>
                      <td class="align-middle text-center text-sm">
                        <span class="badge badge-sm bg-gradient-success">متصل</span>
                      </td>
                      <td class="align-middle text-center">
                        <span class="text-secondary text-xs font-weight-bold">23/04/18</span>
                      </td>
                      <td class="align-middle">
                        <a href="javascript:;" class="text-secondary font-weight-bold text-xs" data-toggle="tooltip" data-original-title="تعديل المستخدم">
                          تعديل
                        </a>
                      </td>
                    </tr>
                    <tr>
                      <td>
                        <div class="d-flex px-2 py-1">
                          <div>
                            <img src="../assets/img/team-3.jpg" class="avatar avatar-sm me-3 border-radius-lg" alt="user2">
                          </div>
                          <div class="d-flex flex-column justify-content-center">
                            <h6 class="mb-0 text-sm">أليكسا ليراس</h6>
                            <p class="text-xs text-secondary mb-0">alexa@creative-tim.com</p>
                          </div>
                        </div>
                      </td>
                      <td>
                        <p class="text-xs font-weight-bold mb-0">مبرمج</p>
                        <p class="text-xs text-secondary mb-0">مطور</p>
                      </td>
                      <td class="align-middle text-center text-sm">
                        <span class="badge badge-sm bg-gradient-secondary">غير متصل</span>
                      </td>
                      <td class="align-middle text-center">
                        <span class="text-secondary text-xs font-weight-bold">11/01/19</span>
                      </td>
                      <td class="align-middle">
                        <a href="javascript:;" class="text-secondary font-weight-bold text-xs" data-toggle="tooltip" data-original-title="تعديل المستخدم">
                          تعديل
                        </a>
                      </td>
                    </tr>
                    <tr>
                      <td>
                        <div class="d-flex px-2 py-1">
                          <div>
                            <img src="../assets/img/team-4.jpg" class="avatar avatar-sm me-3 border-radius-lg" alt="user3">
                          </div>
                          <div class="d-flex flex-column justify-content-center">
                            <h6 class="mb-0 text-sm">لوران بيرييه</h6>
                            <p class="text-xs text-secondary mb-0">laurent@creative-tim.com</p>
                          </div>
                        </div>
                      </td>
                      <td>
                        <p class="text-xs font-weight-bold mb-0">تنفيذي</p>
                        <p class="text-xs text-secondary mb-0">مشاريع</p>
                      </td>
                      <td class="align-middle text-center text-sm">
                        <span class="badge badge-sm bg-gradient-success">متصل</span>
                      </td>
                      <td class="align-middle text-center">
                        <span class="text-secondary text-xs font-weight-bold">19/09/17</span>
                      </td>
                      <td class="align-middle">
                        <a href="javascript:;" class="text-secondary font-weight-bold text-xs" data-toggle="tooltip" data-original-title="تعديل المستخدم">
                          تعديل
                        </a>
                      </td>
                    </tr>
                    <tr>
                      <td>
                        <div class="d-flex px-2 py-1">
                          <div>
                            <img src="../assets/img/team-3.jpg" class="avatar avatar-sm me-3 border-radius-lg" alt="user4">
                          </div>
                          <div class="d-flex flex-column justify-content-center">
                            <h6 class="mb-0 text-sm">مايكل ليفي</h6>
                            <p class="text-xs text-secondary mb-0">michael@creative-tim.com</p>
                          </div>
                        </div>
                      </td>
                      <td>
                        <p class="text-xs font-weight-bold mb-0">مبرمج</p>
                        <p class="text-xs text-secondary mb-0">مطور</p>
                      </td>
                      <td class="align-middle text-center text-sm">
                        <span class="badge badge-sm bg-gradient-success">متصل</span>
                      </td>
                      <td class="align-middle text-center">
                        <span class="text-secondary text-xs font-weight-bold">24/12/08</span>
                      </td>
                      <td class="align-middle">
                        <a href="javascript:;" class="text-secondary font-weight-bold text-xs" data-toggle="tooltip" data-original-title="تعديل المستخدم">
                          تعديل
                        </a>
                      </td>
                    </tr>
                    <tr>
                      <td>
                        <div class="d-flex px-2 py-1">
                          <div>
                            <img src="../assets/img/team-2.jpg" class="avatar avatar-sm me-3 border-radius-lg" alt="user5">
                          </div>
                          <div class="d-flex flex-column justify-content-center">
                            <h6 class="mb-0 text-sm">ريتشارد غران</h6>
                            <p class="text-xs text-secondary mb-0">richard@creative-tim.com</p>
                          </div>
                        </div>
                      </td>
                      <td>
                        <p class="text-xs font-weight-bold mb-0">مدير</p>
                        <p class="text-xs text-secondary mb-0">تنفيذي</p>
                      </td>
                      <td class="align-middle text-center text-sm">
                        <span class="badge badge-sm bg-gradient-secondary">غير متصل</span>
                      </td>
                      <td class="align-middle text-center">
                        <span class="text-secondary text-xs font-weight-bold">04/10/21</span>
                      </td>
                      <td class="align-middle">
                        <a href="javascript:;" class="text-secondary font-weight-bold text-xs" data-toggle="tooltip" data-original-title="تعديل المستخدم">
                          تعديل
                        </a>
                      </td>
                    </tr>
                    <tr>
                      <td>
                        <div class="d-flex px-2 py-1">
                          <div>
                            <img src="../assets/img/team-4.jpg" class="avatar avatar-sm me-3 border-radius-lg" alt="user6">
                          </div>
                          <div class="d-flex flex-column justify-content-center">
                            <h6 class="mb-0 text-sm">ميريام إريك</h6>
                            <p class="text-xs text-secondary mb-0">miriam@creative-tim.com</p>
                          </div>
                        </div>
                      </td>
                      <td>
                        <p class="text-xs font-weight-bold mb-0">مبرمج</p>
                        <p class="text-xs text-secondary mb-0">مطور</p>
                      </td>
                      <td class="align-middle text-center text-sm">
                        <span class="badge badge-sm bg-gradient-secondary">غير متصل</span>
                      </td>
                      <td class="align-middle text-center">
                        <span class="text-secondary text-xs font-weight-bold">14/09/20</span>
                      </td>
                      <td class="align-middle">
                        <a href="javascript:;" class="text-secondary font-weight-bold text-xs" data-toggle="tooltip" data-original-title="تعديل المستخدم">
                          تعديل
                        </a>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>


  </div> --}}




  

  {{-- <p>Current URL: {{ url()->current() }}</p>
  <p>Form will submit to: {{ route('profile.saveAchievements') }}</p>
   --}}




   {{-- هون اختيار جدول للحفظ  --}}
@if ($needsMemorizationProgram)
    <form action="{{ route('setMemorizationProgram') }}" method="POST"
        class="p-4 bg-white shadow rounded-4 border border-2"
        style="max-width: 550px; margin: 40px auto; font-family: 'Cairo', sans-serif; border-color: #c37044;">
        @csrf
        <h4 class="text-center mb-4 fw-bold"
            style="color: #c37044; border-bottom: 2px solid #c37044; padding-bottom: 10px;">
            اختيار برنامج الحفظ اليومي
        </h4>

        <div class="mb-4">
            <label for="memorization_program" class="form-label text-dark fw-semibold">اختر المستوى:</label>
            <select name="memorization_program" id="memorization_program"
                class="form-select border-dark rounded-3 shadow-sm"
                style="background-color: #fdf8f5; color: #000;">
                <option value="half_page">نصف صفحة</option>
                <option value="one_page">صفحة</option>
                <option value="two_pages">صفحتين</option>
            </select>
        </div>

        <div class="text-center">
            <button type="submit"
                class="btn px-5 py-2 rounded-pill shadow text-white"
                style="background-color: #c37044;">
                <i class="bi bi-bookmark-check-fill me-1"></i> حفظ الاختيار
            </button>
        </div>
    </form>
@endif



{{-- نهياة اختيار جدول الحفظ  --}}


   @foreach($student->studentWeeklyPrograms as $studentProgram)
   @if ($loop->index >= $loop->count - 2)
      <div class="card my-4">
     <div class="card-header p-0 position-relative mt-n4 mx-3 z-index-2">
       <div class="shadow" style="background-color: #020202; border-radius: .5rem .5rem 0 0;">
         @php
         $programType = $studentProgram->weeklyProgram->dailyPrograms->first()?->type;
         $typeLabel = $programType === 'حفظ' ? 'جدول حفظ' : 'جدول مراجعة';
         @endphp
         
         <h6 class="text-white text-capitalize ps-3 py-3">
           {{ $typeLabel }} يبدأ من {{ \Carbon\Carbon::parse($studentProgram->weeklyProgram->week_start)->format('Y-m-d') }}
         </h6>
         
       </div>
     </div>
     <div class="card-body px-0 pb-2">
       <div class="table-responsive p-0">
         
         <form method="POST" action="{{ route('profile.saveAchievements') }}">
 
           @csrf
           <input type="hidden" name="weekly_program_id" value="{{ $studentProgram->weeklyProgram->id }}">
           <table class="table align-items-center mb-0 text-center" dir="rtl">
             <thead style="background-color: #f5e9dd;">
               <tr>
                 <th>اليوم</th>
                 <th>النوع</th>
                 <th>الكمية</th>
                 <th>السورة</th>
                 <th>من آية</th>
                 <th>إلى آية</th>
                 <th>ملاحظات</th>
                 @php
                   $isHifz = $studentProgram->weeklyProgram->dailyPrograms->first()?->type === 'حفظ';
                   $isReview = $studentProgram->weeklyProgram->dailyPrograms->first()?->type === 'مراجعة';
                 @endphp
                 @if($isHifz)
                   <th>إنجاز الحفظ</th>
                 @elseif($isReview)
                   <th>إنجاز المراجعة</th>
                 @endif
               </tr>
             </thead>
             <tbody>
              @foreach($studentProgram->weeklyProgram->dailyPrograms as $day)
                @php
                  $today = \Carbon\Carbon::today();
                  $dayDate = \Carbon\Carbon::parse($day->date); // تأكد من أن لديك عمود "date" في جدول daily_programs
                  $isPast = $dayDate->lt($today);
                  $isTodayOrFuture = $dayDate->gte($today);
                @endphp
            
                <tr>
                  <td>{{ $day->day }}</td>
                  <td>{{ $day->type }}</td>
                  <td>{{ $day->portion_type }}</td>
                  <td>{{ $day->surah }}</td>
                  <td>{{ $day->from_verse }}</td>
                  <td>{{ $day->to_verse }}</td>
                  <td>{{ $day->notes ?? '-' }}</td>
            
                  @if($isHifz || $isReview)  <!-- تعديل هنا لعرض الـ checkbox في الحالتين -->
                    <td>
                      @if($day->achievement?->status)
                        <span class="text-success fw-bold">منجز</span>
                      @elseif($isPast)
                        <span class="text-danger fw-bold">غير منجز</span>
                      @else
                        <input type="checkbox" name="achievements[{{ $day->id }}][status]" value="1">
                        <input type="hidden" name="achievements[{{ $day->id }}][type]" value="{{ $day->type }}">
                      @endif
                    </td>
                  @endif
                </tr>
              @endforeach
            </tbody>
            
             
           </table>
           <div class="text-end px-4 py-2">
             <button type="submit" class="btn text-white" style="background-color: #c37044;">
               حفظ الإنجاز
             </button>
           </div>
         </form>
       </div>
     </div>
   </div>
   @else
   
   @endif
 @endforeach
 




  {{-- <div class="row">
    <div class="col-12">
      <div class="card my-4">
        <div class="card-header p-0 position-relative mt-n4 mx-3 z-index-2">
          <div class="bg-gradient-dark shadow-dark border-radius-lg pt-4 pb-3">
            <h6 class="text-white text-capitalize ps-3">جدول المشاريع</h6>
          </div>
        </div>
        <div class="card-body px-0 pb-2">
          <div class="table-responsive p-0">
            <table class="table align-items-center justify-content-center mb-0" dir="rtl">
              <thead>
                <tr>
                  <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">المشروع</th>
                  <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 ps-2">الميزانية</th>
                  <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 ps-2">الحالة</th>
                  <th class="text-uppercase text-secondary text-xxs font-weight-bolder text-center opacity-7 ps-2">الإكمال</th>
                  <th></th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>
                    <div class="d-flex px-2">
                      <div>
                        <img src="../assets/img/small-logos/logo-asana.svg" class="avatar avatar-sm rounded-circle me-2" alt="Asana">
                      </div>
                      <div class="my-auto">
                        <h6 class="mb-0 text-sm">أسانا</h6>
                      </div>
                    </div>
                  </td>
                  <td>
                    <p class="text-sm font-weight-bold mb-0">$2,500</p>
                  </td>
                  <td>
                    <span class="text-xs font-weight-bold">قيد العمل</span>
                  </td>
                  <td class="align-middle text-center">
                    <div class="d-flex align-items-center justify-content-center">
                      <span class="me-2 text-xs font-weight-bold">60%</span>
                      <div>
                        <div class="progress">
                          <div class="progress-bar bg-gradient-info" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width: 60%;"></div>
                        </div>
                      </div>
                    </div>
                  </td>
                  <td class="align-middle">
                    <button class="btn btn-link text-secondary mb-0">
                      <i class="fa fa-ellipsis-v text-xs"></i>
                    </button>
                  </td>
                </tr>
                <tr>
                  <td>
                    <div class="d-flex px-2">
                      <div>
                        <img src="../assets/img/small-logos/github.svg" class="avatar avatar-sm rounded-circle me-2" alt="GitHub">
                      </div>
                      <div class="my-auto">
                        <h6 class="mb-0 text-sm">جيثب</h6>
                      </div>
                    </div>
                  </td>
                  <td>
                    <p class="text-sm font-weight-bold mb-0">$5,000</p>
                  </td>
                  <td>
                    <span class="text-xs font-weight-bold">منتهي</span>
                  </td>
                  <td class="align-middle text-center">
                    <div class="d-flex align-items-center justify-content-center">
                      <span class="me-2 text-xs font-weight-bold">100%</span>
                      <div>
                        <div class="progress">
                          <div class="progress-bar bg-gradient-success" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width: 100%;"></div>
                        </div>
                      </div>
                    </div>
                  </td>
                  <td class="align-middle">
                    <button class="btn btn-link text-secondary mb-0" aria-haspopup="true" aria-expanded="false">
                      <i class="fa fa-ellipsis-v text-xs"></i>
                    </button>
                  </td>
                </tr>
                <tr>
                  <td>
                    <div class="d-flex px-2">
                      <div>
                        <img src="../assets/img/small-logos/logo-atlassian.svg" class="avatar avatar-sm rounded-circle me-2" alt="Atlassian">
                      </div>
                      <div class="my-auto">
                        <h6 class="mb-0 text-sm">أتلاسيان</h6>
                      </div>
                    </div>
                  </td>
                  <td>
                    <p class="text-sm font-weight-bold mb-0">$3,400</p>
                  </td>
                  <td>
                    <span class="text-xs font-weight-bold">ملغي</span>
                  </td>
                  <td class="align-middle text-center">
                    <div class="d-flex align-items-center justify-content-center">
                      <span class="me-2 text-xs font-weight-bold">30%</span>
                      <div>
                        <div class="progress">
                          <div class="progress-bar bg-gradient-danger" role="progressbar" aria-valuenow="30" aria-valuemin="0" aria-valuemax="30" style="width: 30%;"></div>
                        </div>
                      </div>
                    </div>
                  </td>
                  <td class="align-middle">
                    <button class="btn btn-link text-secondary mb-0" aria-haspopup="true" aria-expanded="false">
                      <i class="fa fa-ellipsis-v text-xs"></i>
                    </button>
                  </td>
                </tr>
                <tr>
                  <td>
                    <div class="d-flex px-2">
                      <div>
                        <img src="../assets/img/small-logos/bootstrap.svg" class="avatar avatar-sm rounded-circle me-2" alt="Bootstrap">
                      </div>
                      <div class="my-auto">
                        <h6 class="mb-0 text-sm">بوتستراب</h6>
                      </div>
                    </div>
                  </td>
                  <td>
                    <p class="text-sm font-weight-bold mb-0">$14,000</p>
                  </td>
                  <td>
                    <span class="text-xs font-weight-bold">قيد العمل</span>
                  </td>
                  <td class="align-middle text-center">
                    <div class="d-flex align-items-center justify-content-center">
                      <span class="me-2 text-xs font-weight-bold">80%</span>
                      <div>
                        <div class="progress">
                          <div class="progress-bar bg-gradient-info" role="progressbar" aria-valuenow="80" aria-valuemin="0" aria-valuemax="80" style="width: 80%;"></div>
                        </div>
                      </div>
                    </div>
                  </td>
                  <td class="align-middle">
                    <button class="btn btn-link text-secondary mb-0" aria-haspopup="true" aria-expanded="false">
                      <i class="fa fa-ellipsis-v text-xs"></i>
                    </button>
                  </td>
                </tr>
                <tr>
                  <td>
                    <div class="d-flex px-2">
                      <div>
                        <img src="../assets/img/small-logos/logo-slack.svg" class="avatar avatar-sm rounded-circle me-2" alt="Slack">
                      </div>
                      <div class="my-auto">
                        <h6 class="mb-0 text-sm">سلاك</h6>
                      </div>
                    </div>
                  </td>
                  <td>
                    <p class="text-sm font-weight-bold mb-0">$1,000</p>
                  </td>
                  <td>
                    <span class="text-xs font-weight-bold">ملغي</span>
                  </td>
                  <td class="align-middle text-center">
                    <div class="d-flex align-items-center justify-content-center">
                      <span class="me-2 text-xs font-weight-bold">0%</span>
                      <div>
                        <div class="progress">
                          <div class="progress-bar bg-gradient-success" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="0" style="width: 0%;"></div>
                        </div>
                      </div>
                    </div>
                  </td>
                  <td class="align-middle">
                    <button class="btn btn-link text-secondary mb-0" aria-haspopup="true" aria-expanded="false">
                      <i class="fa fa-ellipsis-v text-xs"></i>
                    </button>
                  </td>
                </tr>
                <tr>
                  <td>
                    <div class="d-flex px-2">
                      <div>
                        <img src="../assets/img/small-logos/devto.svg" class="avatar avatar-sm rounded-circle me-2" alt="Dev.to">
                      </div>
                      <div class="my-auto">
                        <h6 class="mb-0 text-sm">ديفتو</h6>
                      </div>
                    </div>
                  </td>
                  <td>
                    <p class="text-sm font-weight-bold mb-0">$2,300</p>
                  </td>
                  <td>
                    <span class="text-xs font-weight-bold">منتهي</span>
                  </td>
                  <td class="align-middle text-center">
                    <div class="d-flex align-items-center justify-content-center">
                      <span class="me-2 text-xs font-weight-bold">100%</span>
                      <div>
                        <div class="progress">
                          <div class="progress-bar bg-gradient-success" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width: 100%;"></div>
                        </div>
                      </div>
                    </div>
                  </td>
                  <td class="align-middle">
                    <button class="btn btn-link text-secondary mb-0" aria-haspopup="true" aria-expanded="false">
                      <i class="fa fa-ellipsis-v text-xs"></i>
                    </button>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div> --}}